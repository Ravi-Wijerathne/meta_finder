# MetaFinder 🔍

**Universal Metadata Extraction Tool**

Extract metadata from **ANY** file type and save it to a `.txt` file!

## 🎯 Features

- ✅ **Universal File Support** - Works with ANY file type
- ✅ **Smart Detection** - Automatically detects file types
- ✅ **Specialized Extractors** - Optimized for images, audio, video, documents, archives
- ✅ **Beautiful GUI** - Easy-to-use interface built with tkinter
- ✅ **Rich Metadata** - Extracts EXIF, ID3, PDF properties, video codecs, and more
- ✅ **Preview** - View extracted metadata before saving
- ✅ **Export to Text** - Clean, readable `.txt` output

## 🎨 Supported File Types

### Images
- JPEG, PNG, GIF, TIFF, BMP, WebP
- EXIF data, GPS info, camera settings

### Audio
- MP3, FLAC, WAV, OGG, M4A, AAC
- Artist, album, duration, bitrate, ID3 tags

### Video
- MP4, AVI, MKV, MOV, WMV, FLV
- Resolution, codec, duration, frame rate

### Documents
- PDF, DOCX, TXT
- Author, title, creation date, page count

### Archives
- ZIP, TAR, 7Z, RAR
- File list, compression ratio

### Generic
- **ANY OTHER FILE TYPE**
- File hashes (MD5, SHA256), magic bytes, binary inspection

## 🚀 Installation

### 1. Clone the repository
```bash
git clone https://github.com/Ravi-Wijerathne/meta_finder.git
cd meta_finder
```

### 2. Install dependencies
```bash
pip install -r requirements.txt
```

**Note for Windows users:** The `python-magic-bin` package is specifically for Windows and provides the `libmagic` library.

### Optional: FFmpeg (for advanced video metadata)
- Download from: https://ffmpeg.org/download.html
- Add to system PATH

## 📖 Usage

### GUI Mode (Recommended)

Run the application:
```bash
python main.py
```

Steps:
1. Click **"Browse"** to select any file
2. Choose output location (auto-generated by default)
3. Click **"Extract Metadata"**
4. View preview and save to `.txt` file

### Command Line Mode

You can also use the extractors programmatically:

```python
from utils.file_detection import detect_type, get_file_category
from utils.normalize import normalize_metadata
from utils.text_writer import save_metadata
from extractors import image_extractor, audio_extractor

# Detect file type
file_path = "path/to/your/file.jpg"
mime_type = detect_type(file_path)
category = get_file_category(mime_type)

# Extract metadata
if category == 'image':
    metadata = image_extractor.extract(file_path)

# Convert to text
text = normalize_metadata(metadata, file_path, mime_type)

# Save
save_metadata(text, "output_metadata.txt")
```

## 🏗️ Architecture

```
meta_finder/
├── extractors/          # File-type specific extractors
│   ├── image_extractor.py
│   ├── audio_extractor.py
│   ├── video_extractor.py
│   ├── document_extractor.py
│   ├── archive_extractor.py
│   └── generic_extractor.py
├── utils/               # Utility functions
│   ├── file_detection.py
│   ├── normalize.py
│   └── text_writer.py
├── main.py             # GUI application
└── requirements.txt
```

## 🧰 Libraries Used

- **python-magic-bin** - File type detection
- **exifread** & **Pillow** - Image EXIF data
- **mutagen** & **tinytag** - Audio metadata
- **hachoir** - Binary file inspection
- **PyPDF2** - PDF metadata
- **python-docx** - Word documents
- **py7zr** - 7-Zip archives
- **tkinter** - GUI framework (built-in)

## 🎨 Screenshot

```
┌─────────────────────────────────────────┐
│        🔍 MetaFinder                    │
│  Extract metadata from ANY file type    │
├─────────────────────────────────────────┤
│ 1. Select Input File                    │
│  [path/to/file.jpg      ] [📂 Browse]   │
│                                          │
│ 2. Output Location                      │
│  [path/to/output.txt    ] [📁 Choose]   │
│                                          │
│  [🚀 Extract Metadata]  [🗑️ Clear]      │
│                                          │
│ 3. Metadata Preview                     │
│  ┌────────────────────────────────────┐ │
│  │ METADATA EXTRACTION REPORT         │ │
│  │ File: example.jpg                  │ │
│  │ Image Width: 1920                  │ │
│  │ Image Height: 1080                 │ │
│  │ ...                                │ │
│  └────────────────────────────────────┘ │
├─────────────────────────────────────────┤
│ Ready to extract metadata               │
└─────────────────────────────────────────┘
```

## 🤝 Contributing

Contributions are welcome! Feel free to:
- Add support for new file types
- Improve extractors
- Enhance the GUI
- Fix bugs

## 📝 License

This project is open-source and available for educational purposes.

## ⚠️ Notes

- Some extractors require external tools (e.g., `ffprobe` for advanced video metadata)
- Very large files (>100MB) skip hash calculation for performance
- Binary data is displayed as `<binary data: X bytes>`

## 🎉 Enjoy!

Extract metadata from **ANYTHING**! 🚀
